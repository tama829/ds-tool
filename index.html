<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>æ–™é‡‘æ¯”è¼ƒãƒ„ãƒ¼ãƒ«</title>

<!-- ãƒ•ã‚©ãƒ³ãƒˆ -->

<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>

body {
  font-family: "Noto Sans JP", "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #fafafa;
  margin: 12px;
}

/* ===== ãƒ­ã‚´ ===== */
.logo-wrap {
  display: flex;
  justify-content: center;
  margin-bottom: 8px;
}

.logo-wrap img {
  max-width: 360px;
  width: 100%;
  height: auto;
}

h1 {
  text-align: center;
  color: #c7000b;
  margin-bottom: 6px;
}

.note {
  text-align: center;
  font-size: 12px;
  color: #666;
  margin-bottom: 16px;
}

/* ===== è¡Œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ ===== */
.row {
  display: grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  gap: 10px;
  margin-bottom: 6px;
}

/* ===== ã‚»ãƒ« ===== */
.cell {
  background: #ffffff;
  border: 1px solid #ddd;
  border-radius: 2px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  padding: 0 8px;
  font-size: 14px;
}

/* ===== å…¥åŠ›ç³»ï¼ˆæ ã«å®Œå…¨ãƒ•ã‚£ãƒƒãƒˆï¼‰ ===== */
.cell input,
.cell select {
  width: 100%;
  height: 100%;
  border: none;
  background: transparent;
  outline: none;
  font-size: 14px;
  font-family: "Inter", sans-serif;
}

/* è¦‹å‡ºã— */
.header {
  background: #fff0f0;
  font-weight: bold;
  color: #c7000b;
}

/* ===== ç‰¹åˆ¥ãƒ˜ãƒƒãƒ€ãƒ¼ ===== */

/* ãƒã‚¤æ´»MAX */
.head-poimax {
  border: 2px solid #c89932;
  color: #c89932;
  font-weight: 700;
  background: #fff1cf;
}

/* ãƒ—ãƒ©ãƒ³å */
.head-plan {
  border: 2px solid #333;
  background: #fff;
}

.head-plan select {
  color: #333;
  font-weight: 600;
}

/* é‡‘é¡ */
.money {
  font-family: "Inter", sans-serif;
  font-weight: 600;
}

/* å‰²å¼•å¾Œæ–™é‡‘ */
.after {
  background: #fff5f5;
  border: 2px solid #c7000b;
  color: #c7000b;
  font-weight: bold;
}

/* å®Ÿè³ªæ–™é‡‘ */
.final {
  background: #fff5f5;
  border: 2px solid #c7000b;
  color: #c7000b;
  font-weight: bold;
}

/* å·®é¡ */
.diff {
  text-align: center;
  font-size: 22px;
  font-weight: bold;
  color: #c7000b;
  margin-top: 16px;
}

/*åŸºæœ¬æ–™é‡‘ä¸­å¤®æƒãˆ*/
.number-input {
  text-align: center;
}

.price-cell {
  position: relative;
}

.price-cell input {
  padding-right: 24px;
}

.base-price {
  font-family: "Inter", sans-serif;
  font-size: 15px;
  text-align: center;
}

.base-price input {
  font-weight: 600; 
}

.yen {
  position: absolute;
  right: 13px;
  font-size: 15px;
  color: #666;
}

/* ===== ãƒã‚¤æ´»å¹ãå‡ºã— ===== */

.balloon {
  min-width: 60px;
  height: 30px;
  padding: 0 8px;  
  font-size: 14px;
  color: #fff;
  border-radius: 10px;
  background: #c7000b;
  position: absolute;
  top: -20px;
  z-index: 5;
  display: flex;
  justify-content: center;
  align-items: center;
}

.balloon::after {
  content: "";
  position: absolute;
  top: 100%;
  border: 5px solid transparent;
  border-top-color: #c7000b;
}

/* å·¦ç”¨ */
.balloon-left {
  left: -6px;
}
.balloon-left::after {
  left: 10px;
}
.balloon-left input {
  color: #fff;
}
.balloon-left input::placeholder {
  color: rgba(255,255,255,0.7);
}

/* å³ç”¨ */
.balloon-right {
  right: -6px;
}
.balloon-right::after {
  right: 10px;
}
.balloon-right input {
  color: #fff;
}
.balloon-right input::placeholder {
  color: rgba(255,255,255,0.7);
}

.poi-row {
  margin-top: 20px;
}

.disabled-cell {
  background: #f0f0f0 !important;
  color: #999;
  pointer-events: none;
}

</style>
</head>

<body>

<!-- ãƒ­ã‚´ -->
<div class="logo-wrap">
  <img src="logo.png.PNG" alt="ãƒ‰ã‚³ãƒ¢ãƒã‚¤æ´»MAX æ–™é‡‘æ¯”è¼ƒãƒ„ãƒ¼ãƒ«">
</div>

<!-- ===== ãƒ˜ãƒƒãƒ€ãƒ¼ ===== -->
<div class="row">
  <div class="cell header head-poimax">ãƒã‚¤æ´»MAX</div>
  <div class="cell">é …ç›®</div>

<div class="cell header head-plan">
  <select id="r-plan" onchange="setPlanPrice()">
    <option value="">ãƒ—ãƒ©ãƒ³é¸æŠ</option>
    <option value="5698">ãƒ‰ã‚³ãƒ¢MAX(ã€œ1GB)</option>
    <option value="6798">ãƒ‰ã‚³ãƒ¢MAX(1GBã€œ3GB)</option>
    <option value="8448">ãƒ‰ã‚³ãƒ¢MAX(3GBã€œç„¡åˆ¶é™)</option>
    <option value="7898">ãƒ‰ã‚³ãƒ¢ãƒã‚¤æ´»20(ã€œ20GB)</option>
    <option value="9570">ãƒ‰ã‚³ãƒ¢ãƒã‚¤æ´»20(20GBã€œç„¡åˆ¶é™)</option>
    <option value="2750">ãƒ‰ã‚³ãƒ¢mini(4GB)</option>
    <option value="3850">ãƒ‰ã‚³ãƒ¢mini(10GB)</option>
    <option value="2970">ahamoï¼ˆ30GBï¼‰</option>
    <option value="4950">ahamoå¤§ç››ã‚Š(110GB)</option>
    <option value="7150">ahamoãƒã‚¤æ´»</option>
    <option value="4565">eximo(ã€œ1GB)</option>
    <option value="5665">eximoï¼ˆ1GBã€œ3GBï¼‰</option>
    <option value="7315">eximoï¼ˆ3GBã€œç„¡åˆ¶é™ï¼‰</option>
    <option value="10613">eximoãƒã‚¤æ´»</option>
    <option value="550">irumoï¼ˆ0.5GBï¼‰</option>
    <option value="2167">irumoï¼ˆ3GBï¼‰</option>
    <option value="2827">irumoï¼ˆ6GBï¼‰</option>
    <option value="3377">irumoï¼ˆ9GBï¼‰</option>
    <option value="3465">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆï¼ˆã€œ1GBï¼‰</option>
    <option value="4565">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆï¼ˆã€œ3GBï¼‰</option>
    <option value="5665">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆï¼ˆã€œ5GBï¼‰</option>
    <option value="6765">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆï¼ˆã€œ7GBï¼‰</option>
    <option value="3278">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆ2å¹´å®šæœŸï¼ˆã€œ1GBï¼‰</option>
    <option value="4378">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆ2å¹´å®šæœŸï¼ˆã€œ3GBï¼‰</option>
    <option value="5478">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆ2å¹´å®šæœŸï¼ˆã€œ5GBï¼‰</option>
    <option value="6578">ã‚®ã‚¬ãƒ©ã‚¤ãƒˆ2å¹´å®šæœŸï¼ˆã€œ7GBï¼‰</option>

  </select>
</div>
</div>

<!-- ===== åŸºæœ¬æ–™é‡‘ ===== -->
<div class="row">
  <div class="cell money">11,748å††</div>
  <div class="cell">åŸºæœ¬æ–™é‡‘</div>
  <div class="cell price-cell base-price">
    <input type="number" id="r-base" class="number-input" placeholder="é‡‘é¡å…¥åŠ›">
    <span class="yen">å††</span>
  </div>
</div>

<!-- ===== dã‚«ãƒ¼ãƒ‰ ===== -->
<div class="row">
  <div class="cell">
    <select id="l-card" onchange="applyDcard('l')">
      <option value="">ãƒ¼</option>
      <option value="normal">dã‚«ãƒ¼ãƒ‰</option>
      <option value="goldu">dã‚«ãƒ¼ãƒ‰GOLD U</option>
      <option value="gold">dã‚«ãƒ¼ãƒ‰GOLD</option>
      <option value="platinum">dã‚«ãƒ¼ãƒ‰PLATINUM</option>
    </select>
  </div>

  <div class="cell">dã‚«ãƒ¼ãƒ‰</div>

  <div class="cell">
    <select id="r-card" onchange="applyDcard('r')">
      <option value="">ãƒ¼</option>
      <option value="normal">dã‚«ãƒ¼ãƒ‰</option>
      <option value="goldu">dã‚«ãƒ¼ãƒ‰GOLD U</option>
      <option value="gold">dã‚«ãƒ¼ãƒ‰GOLD</option>
      <option value="platinum">dã‚«ãƒ¼ãƒ‰PLATINUM</option>
    </select>
  </div>
</div>

<!-- ===== å‰²å¼•è¡Œä¸€è¦§ ===== -->
<!-- ã¿ã‚“ãªãƒ‰ã‚³ãƒ¢å‰² -->
<div class="row">
  <div class="cell">
    <select id="l-minna" class="l-discount" data-other="l-d1-o-1" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="550">550å††</option>
      <option value="1210">1,210å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="l-d1-o-1-wrap" style="display:none;">
      <input type="number" id="l-d1-o-1" class="l-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
  <div class="cell">ã¿ã‚“ãªãƒ‰ã‚³ãƒ¢å‰²</div>
  <div class="cell">
    <select id="r-minna" class="r-discount" data-other="r-d1-o-1" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="550">550å††</option>
      <option value="1100">1,100å††</option>
      <option value="1210">1,210å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="r-d1-o-1-wrap" style="display:none;">
      <input type="number" id="r-d1-o-1" class="r-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
</div>

<!-- é•·æœŸåˆ©ç”¨å‰² -->
<div class="row">
  <div class="cell">
    <select id="l-long" class="l-discount" data-other="l-d1-o-2" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="110">110å††</option>
      <option value="220">220å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="l-d1-o-2-wrap" style="display:none;">
      <input type="number" id="l-d1-o-2" class="l-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
  <div class="cell">é•·æœŸåˆ©ç”¨å‰²</div>
  <div class="cell">
    <select id="r-long" class="r-discount" data-other="r-d1-o-2" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="110">110å††</option>
      <option value="220">220å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="r-d1-o-2-wrap" style="display:none;">
      <input type="number" id="r-d1-o-2" class="r-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
</div>

<!-- dã‚«ãƒ¼ãƒ‰ãŠæ”¯æ‰•ã„å‰² -->
<div class="row">
  <div class="cell">
    <select id="l-dcard-discount" class="l-discount" data-other="l-d1-o-3" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="220">220å††</option>
      <option value="550">550å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="l-d1-o-3-wrap" style="display:none;">
      <input type="number" id="l-d1-o-3" class="l-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
  <div class="cell">dã‚«ãƒ¼ãƒ‰ãŠæ”¯æ‰•ã„å‰²</div>
  <div class="cell">
    <select id="r-dcard-discount" class="r-discount" data-other="r-d1-o-3" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="187">187å††</option>
      <option value="220">220å††</option>
      <option value="550">550å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="r-d1-o-3-wrap" style="display:none;">
      <input type="number" id="r-d1-o-3" class="r-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
</div>

<!-- ãƒ‰ã‚³ãƒ¢å…‰/home5Gã‚»ãƒƒãƒˆå‰² -->
<div class="row">
  <div class="cell">
    <select id="l-hikari" class="l-discount" data-other="l-d1-o-4" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="1210">1,210å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="l-d1-o-4-wrap" style="display:none;">
      <input type="number" id="l-d1-o-4" class="l-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
  <div class="cell">ãƒ‰ã‚³ãƒ¢å…‰/home5Gã‚»ãƒƒãƒˆå‰²</div>
  <div class="cell">
    <select id="r-hikari" class="r-discount" data-other="r-d1-o-4" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="550">550å††</option>
      <option value="1100">1,100å††</option>
      <option value="1210">1,210å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="r-d1-o-4-wrap" style="display:none;">
      <input type="number" id="r-d1-o-4" class="r-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
</div>

<!-- ã§ã‚“ãã‚»ãƒƒãƒˆå‰² -->
<div class="row">
  <div class="cell">
    <select id="l-denki" class="l-discount" data-other="l-d1-o-5" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="110">110å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="l-d1-o-5-wrap" style="display:none;">
      <input type="number" id="l-d1-o-5" class="l-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
  <div class="cell">ã§ã‚“ãã‚»ãƒƒãƒˆå‰²</div>
  <div class="cell">
    <select id="r-denki" class="r-discount" data-other="r-d1-o-5" onchange="handleOther(this)">
      <option value="0">ãƒ¼</option>
      <option value="110">110å††</option>
      <option value="other">ãã®ä»–</option>
    </select>
    <div id="r-d1-o-5-wrap" style="display:none;">
      <input type="number" id="r-d1-o-5" class="r-discount-other number-input" placeholder="é‡‘é¡">
    </div>
  </div>
</div>

<!-- ãã®ä»–å‰²å¼• -->
<div class="row">
  <div class="cell price-cell">
    <input type="number" class="l-discount-other number-input" placeholder="é‡‘é¡å…¥åŠ›">
    <span class="yen">å††</span>
  </div>
  <div class="cell">ãã®ä»–å‰²å¼•</div>
  <div class="cell price-cell">
    <input type="number" class="r-discount-other number-input" placeholder="é‡‘é¡å…¥åŠ›">
    <span class="yen">å††</span>
  </div>
</div>

<!-- å‰²å¼•å¾Œæ–™é‡‘ -->
<div class="row">
  <div class="cell after" id="l-after">â€”</div>
  <div class="cell header">å‰²å¼•å¾Œæ–™é‡‘</div>
  <div class="cell after" id="r-after">â€”</div>
</div>

<!-- ãƒã‚¤ãƒ³ãƒˆåŒºåˆ‡ã‚Šç·š -->
<div class="row">
  <div class="cell" style="grid-column: 1 / -1; background: transparent; border: none; padding: 0;">
    <div style="
      width: 100%;
      height: 2px;
      background: #c7000b;
      border-radius: 2px;
    "></div>
  </div>
</div>

<!-- é€šå¸¸é‚„å…ƒ-->
<div class="row">
  <div class="cell price-cell">
    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
  <div class="cell">é€šå¸¸é‚„å…ƒ 1%</div>
  <div class="cell price-cell">
    <input type="number" class="r-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
</div>

<!-- ãƒã‚¤æ´»ç‰¹å…¸ -->
<div class="row poi-row">
  <!-- å·¦ï¼ˆå¸¸ã«ãƒã‚¤æ´»ï¼‰ -->
  <div class="cell price-cell">
    <span class="balloon balloon-left">10%é‚„å…ƒ</span>
    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>

  <div class="cell">ãƒã‚¤æ´»ç‰¹å…¸</div>

  <!-- å³ï¼ˆæ¡ä»¶ä»˜ãï¼‰ -->
  <div class="cell price-cell" id="poi-cell-r">

<span class="balloon balloon-right" id="poi-balloon-r" style="display:none;">
  <div style="display:flex; gap:4px; align-items:center;">
    <input
      type="number"
      id="r-poi-rate"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
  </div>
</span>

    <!-- ãƒã‚¤æ´»ã˜ã‚ƒãªã„æ™‚ã®ã€Œãƒ¼ã€ -->
    <span id="poi-dash-r" style="display:flex; align-items:center; color:#aaa;">
      ãƒ¼
    </span>

    <input
      type="number"
      class="r-point number-input"
      id="poi-input-r"
      placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›"
      style="display:none;"
    >
    <span class="yen" id="poi-yen-r" style="display:none;">pt</span>
  </div>
</div>

<!-- ã‚±ãƒ¼ã‚¿ã‚¤æ–™é‡‘-->
<div class="row poi-row">
  <div class="cell price-cell">
    <span class="balloon balloon-left">    <input
      type="number"
      id="l-phone-rate"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
</span>
    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>

  <div class="cell">ã‚±ãƒ¼ã‚¿ã‚¤æ–™é‡‘</div>

  <div class="cell price-cell">

    <span class="balloon balloon-right">    <input
      type="number"
      id="r-phone-rate"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
</span>

    <input type="number" class="r-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
</div>

<!-- ãƒ‰ã‚³ãƒ¢å…‰-->
<div class="row poi-row">
  <div class="cell price-cell">

    <span class="balloon balloon-left">    <input
      type="number"
      id="l-hikari-rate"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
</span>

    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>

  <div class="cell">ãƒ‰ã‚³ãƒ¢å…‰ </div>

  <div class="cell price-cell">

    <span class="balloon balloon-right">    <input
      type="number"
      id="r-hikari-rate"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
</span>

    <input type="number" class="r-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
</div>

<!-- ãƒ‰ã‚³ãƒ¢ã§ã‚“ã-->
<div class="row poi-row">
  <div class="cell price-cell">

    <span class="balloon balloon-left">    <input
      type="number"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
</span>

    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>

  <div class="cell">ãƒ‰ã‚³ãƒ¢ã§ã‚“ã</div>

  <div class="cell price-cell">

    <span class="balloon balloon-right">    <input
      type="number"
      class="rate-input"
      placeholder="00"
      min="0"
      max="99"
      inputmode="numeric"
      style="
        width: 23px;
        height: 22px;
        font-size: 13px;
        text-align: center;
        padding: 0;
        border: none;
        background: transparent;
        border-bottom: 1px solid #ccc;
        font-family: "Noto Sans JP", sans-serif;
      "
    >
    <span>%é‚„å…ƒ</span>
</span>

    <input type="number" class="r-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
</div>

<!-- ãƒã‚¤æ´»ãƒ•ã‚¡ãƒŸãƒªãƒ¼ç‰¹å…¸-->
<div class="row">
  <div class="cell price-cell">
    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
  <div class="cell">ãƒã‚¤æ´»ãƒ•ã‚¡ãƒŸãƒªãƒ¼ç‰¹å…¸</div>
<div class="cell price-cell">
  <!-- ãƒã‚¤æ´»ã˜ã‚ƒãªã„æ™‚ -->
  <span
    id="family-dash-r"
    style="display:flex; align-items:center; color:#aaa;"
  >
    ãƒ¼
  </span>
  <!-- ãƒã‚¤æ´»ã®æ™‚ -->
  <input
    type="number"
    class="r-point number-input"
    id="family-input-r"
    placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›"
    style="display:none;"
  >
  <span
    class="yen"
    id="family-yen-r"
    style="display:none;"
  >
pt
</span>
</div>
</div>

<!-- ãã®ä»–ãƒã‚¤ãƒ³ãƒˆ-->
<div class="row">
  <div class="cell price-cell">
    <input type="number" class="l-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
  <div class="cell">ãã®ä»–ãƒã‚¤ãƒ³ãƒˆ</div>
  <div class="cell price-cell">
    <input type="number" class="r-point number-input" placeholder="ãƒã‚¤ãƒ³ãƒˆå…¥åŠ›">
    <span class="yen">pt</span>
  </div>
</div>

<!-- å®Ÿè³ªæ–™é‡‘ -->
<div class="row">
  <div class="cell final" id="l-final">â€”</div>
  <div class="cell header">å®Ÿè³ªæ–™é‡‘</div>
  <div class="cell final" id="r-final">â€”</div>
</div>

<div class="diff" id="diff">å·®é¡ï¼šâ€”</div>

<script>
function n(value){return Number(value||0);}

function setPlanPrice(){
  const plan = document.getElementById("r-plan");
  const price = plan.value;
  document.getElementById("r-base").value = price || "";

  const text = plan.options[plan.selectedIndex].text;
  const isPoi = text.includes("ãƒã‚¤æ´»");

  // ===== ãƒã‚¤æ´»ç‰¹å…¸ =====
  document.getElementById("poi-balloon-r").style.display = isPoi ? "block" : "none";
  document.getElementById("poi-input-r").style.display   = isPoi ? "block" : "none";
  document.getElementById("poi-yen-r").style.display     = isPoi ? "block" : "none";
  document.getElementById("poi-dash-r").style.display    = isPoi ? "none"  : "flex";

  // ===== ãƒã‚¤æ´»ãƒ•ã‚¡ãƒŸãƒªãƒ¼ç‰¹å…¸ =====
  document.getElementById("family-input-r").style.display = isPoi ? "block" : "none";
  document.getElementById("family-yen-r").style.display   = isPoi ? "block" : "none";
  document.getElementById("family-dash-r").style.display  = isPoi ? "none"  : "flex";

  calc();
}


// ==== ãƒ—ãƒ©ãƒ³åˆ¤å®šç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ === //
function getPlanType() {
  const plan = document.getElementById("r-plan");
  if (!plan.value) return "";

  const t = plan.options[plan.selectedIndex].text;

  if (t.includes("MAX")) return "MAX";
  if (t.includes("20")) return "20";
  if (t.includes("irumo")) return "irumo";
  if (t.includes("mini")) return "mini";
  if (t.includes("eximo")) return "eximo";
  if (t.includes("ã‚®ã‚¬ãƒ©ã‚¤ãƒˆ")) return "gigalite";
  if (t.includes("ahamo")) return "ahamo";

  return "";
}

//=== dã‚«ãƒ¼ãƒ‰ãƒã‚¹ã‚¿===//
const DCARD = {
  normal:   { discount: 220, rate: 1 },
  goldu:    { discount: 550, rate: 5 },
  gold:     { discount: 550, rate: 10 },
  platinum: { discount: 550, rate: 20 }
};

//===å‰²å¼•é‡‘é¡ã‚»ãƒƒãƒˆ===//
function setDiscount(side, value) {
  const el = document.getElementById(`${side}-dcard-discount`);
  if (!el) return;
  el.value = value;
}

//===é‚„å…ƒç‡ã‚»ãƒƒãƒˆ===//
function setRate(id, value) {
  const el = document.getElementById(id);
  if (!el) return;
  el.value = value;
}

// === ã‚°ãƒ¬ãƒ¼ã‚¢ã‚¦ãƒˆ === //
function disableDiscount(ids, disabled) {
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.disabled = disabled;
    el.closest(".cell")?.classList.toggle("disabled-cell", disabled);
  });
}

// === ãƒ¡ã‚¤ãƒ³å‡¦ç† === //
function applyDcard(side) {
  const card = document.getElementById(`${side}-card`).value;
  if (!card) return;

  const plan = side === "r" ? getPlanType() : "";

  // ===== å‰²å¼•å¯¾è±¡å¤– =====
  if (side === "r") {
    disableDiscount(
      ["r-minna", "r-long", "r-denki"],
      ["irumo", "gigalite"].includes(plan)
    );

    disableDiscount(
      ["r-minna", "r-long"],
      plan === "mini"
    );

disableDiscount(
      ["r-minna", "r-long", "r-dcard-discount",
"r-hikari", "r-denki"],
      plan === "ahamo"
    );

    disableDiscount(
      ["r-long", "r-denki"],
      plan === "eximo"
    );
  }

  // ===== dã‚«ãƒ¼ãƒ‰å‰² =====
  if (plan !== "ahamo") {
    const value =
      ["irumo", "eximo", "gigalite"].includes(plan)
        ? 187
        : DCARD[card].discount;

    setDiscount(side, value);
  }

  // ===== é‚„å…ƒç‡ =====
  setRate(`${side}-phone-rate`, DCARD[card].rate);
  setRate(`${side}-hikari-rate`, DCARD[card].rate);

  // ===== ãƒã‚¤æ´»=====
  if (side === "r" && plan === "20") {
    setRate("r-poi-rate", 5);
  }
  calc();
}

// ã€Œãã®ä»–ã€å…¥åŠ›ã®è¡¨ç¤ºåˆ‡æ›¿
function handleOther(select){
  const otherId = select.dataset.other;
  const wrap = document.getElementById(otherId+"-wrap");
  if(select.value==="other"){wrap.style.display="flex";}
  else{wrap.style.display="none";document.getElementById(otherId).value="";}
  calc();
}

// å‰²å¼•åˆè¨ˆ
function sumDiscounts(prefix){
  let total=0;
  document.querySelectorAll(`.${prefix}-discount`).forEach(sel=>{
    if(sel.value==="other"){total+=n(document.getElementById(sel.dataset.other).value);}
    else{total+=n(sel.value);}
  });
  document.querySelectorAll(`.${prefix}-discount-other`).forEach(inp=>total+=n(inp.value));
  return total;
}

// ãƒã‚¤ãƒ³ãƒˆåˆè¨ˆ
function sumPoints(prefix){
  let total=0;
  document.querySelectorAll(`.${prefix}-point`).forEach(p=>total+=n(p.value));
  return total;
}

function calc(){
  const leftBase=11748;
  const rightBase=n(document.getElementById("r-base").value);

  const lDiscount=sumDiscounts("l");
  const rDiscount=sumDiscounts("r");

  const lAfter=leftBase-lDiscount;
  const rAfter=rightBase-rDiscount;

  document.getElementById("l-after").textContent=lAfter+"å††";
  document.getElementById("r-after").textContent=rAfter+"å††";

  const lFinal=lAfter-sumPoints("l");
  const rFinal=rAfter-sumPoints("r");

  document.getElementById("l-final").textContent=lFinal+"å††";
  document.getElementById("r-final").textContent=rFinal+"å††";

  const diff=lFinal-rFinal;
  document.getElementById("diff").innerHTML=
    diff<0 ? `ãƒã‚¤æ´»MAXã®æ–¹ãŒå®Ÿè³ª ${Math.abs(diff)}å†† ãŠå¾—ğŸŠ` : `å·®é¡ï¼š${diff}å††`;
}

document.addEventListener("input",calc);
</script>

</body>
</html>




